!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("@cloudinary/angular-5.x",["exports","@angular/core","@angular/common"],e):e((t.cloudinary=t.cloudinary||{},t.cloudinary["angular-5"]=t.cloudinary["angular-5"]||{},t.cloudinary["angular-5"].x={}),t.ng.core,t.ng.common)}(this,function(t,n,i){"use strict";function r(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a}function o(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t}var e=function(t){return t&&"string"==typeof t&&null!==t.trim().match(/^{[\s\S]*?}$/)},a=function(t){return t&&("NamedNodeMap"===t.constructor.name||t instanceof NamedNodeMap)},s=function(n){var o={};return Object.keys(n).forEach(function(t){var e=n[t].name,r=n[t].value;o[e]=r}),o},c=function(t){var n=t;return e(t)?n=JSON.parse(t):a(t)&&(n=s(t)),Array.isArray(n)?n=n.map(function(t){return c(t)}):"object"==typeof n&&Object.keys(n).forEach(function(t){var e=t.replace(/-/g,"_").toLocaleLowerCase().replace(/^cld(-|_)?/,""),r=c(n[t]);delete n[t],n[e]=r}),n},l=function(){function t(t,e){t.CloudinaryJQuery?this._cloudinaryInstance=new t.CloudinaryJQuery(e):this._cloudinaryInstance=new t.Cloudinary(e)}return Object.defineProperty(t.prototype,"cloudinaryInstance",{get:function(){return this._cloudinaryInstance},enumerable:!0,configurable:!0}),t.prototype.config=function(){return this._cloudinaryInstance.config()},t.prototype.url=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=this._cloudinaryInstance).url.apply(t,o(e))},t.prototype.imageTag=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=this._cloudinaryInstance).imageTag.apply(t,o(e))},t.prototype.videoTag=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=this._cloudinaryInstance).videoTag.apply(t,o(e))},t.prototype.responsive=function(t,e){this._cloudinaryInstance.cloudinary_update(t,e),this._cloudinaryInstance.responsive(e,!1)},t.prototype.toCloudinaryAttributes=function(t,e){var r=this,n=c(t);return e&&0<e.length&&(n.transformation=[],e.forEach(function(t){n.transformation.push(r.toCloudinaryAttributes(t.getAttributes()))})),""!==n.responsive&&"true"!==n.responsive&&!0!==n.responsive||(n.responsive=!0),n},t}();var u=function(){return"undefined"!=typeof window},d=function(){function t(t){this.el=t}return t.prototype.getAttributes=function(){return this.el.nativeElement.attributes},t.decorators=[{type:n.Directive,args:[{selector:"cl-transformation"}]}],t.ctorParameters=function(){return[{type:n.ElementRef}]},t}(),p=function(){function t(t){this.cloudinary=t,this.options={}}return t.prototype.setWidth=function(t){this.itemWidth=t},t.prototype.setHeight=function(t){this.itemHeight=t},t.prototype.setPublicId=function(t){this.publicId=t},t.prototype.ngAfterContentChecked=function(){this.placeholderImg=this.getPlaceholderImage()},t.prototype.getPlaceholderImage=function(){var t={vectorize:{effect:"vectorize",quality:1},pixelate:{effect:"pixelate",quality:1,fetch_format:"auto"},blur:{effect:"blur:2000",quality:1,fetch_format:"auto"},solid:[{width:"iw_div_2",aspect_ratio:1,crop:"pad",background:"auto"},{crop:"crop",width:10,height:10,gravity:"north_east"},{width:"iw",height:"ih",crop:"fill"},{fetch_format:"auto",quality:"auto"}]},e=[].concat.apply([],[this.options,t[this.type]||t.blur]);return this.cloudinary.url(this.publicId,{transformation:e})},t.decorators=[{type:n.Component,args:[{selector:"cl-placeholder",template:'<img [src]="this.placeholderImg" [style.width.px]="this.itemWidth" [style.height.px]="this.itemHeight">'}]}],t.ctorParameters=function(){return[{type:l}]},t.propDecorators={type:[{type:n.Input,args:["type"]}],itemWidth:[{type:n.HostBinding,args:["style.width"]}],itemHeight:[{type:n.HostBinding,args:["style.height"]}],publicId:[{type:n.HostBinding,args:["attr.public-id"]}]},t}(),h=function(){function t(t,e){this.el=t,this.cloudinary=e,this.onLoad=new n.EventEmitter,this.onError=new n.EventEmitter,this.shouldShowPlaceHolder=!0}return t.prototype.ngOnInit=function(){var t=this;if(u()){this.observer=new MutationObserver(function(){t.loadImage()});this.observer.observe(this.el.nativeElement,{attributes:!0,childList:!0})}},t.prototype.ngOnChanges=function(t){t.publicId&&!t.publicId.isFirstChange()&&this.loadImage()},t.prototype.ngOnDestroy=function(){this.observer&&this.observer.disconnect&&this.observer.disconnect()},t.prototype.ngAfterViewInit=function(){this.loadImage()},t.prototype.ngAfterContentChecked=function(){this.width&&this.placeholderComponent&&this.placeholderComponent.setWidth(this.width),this.height&&this.placeholderComponent&&this.placeholderComponent.setHeight(this.height),this.placeholderComponent&&this.placeholderComponent.setPublicId(this.publicId)},t.prototype.hasLoaded=function(){this.shouldShowPlaceHolder=!1},t.prototype.loadImage=function(){var e=this;if(u()){if(!this.publicId)throw new Error("You must set the public id of the image to load, e.g. <cl-image public-id={{photo.public_id}}...></cl-image>");var t=this.el.nativeElement,r=t.children[0];r.onload=function(t){e.onLoad.emit(t)},r.onerror=function(t){e.onError.emit(t)};var n=this.cloudinary.toCloudinaryAttributes(t.attributes,this.transformations);(this.clientHints||"undefined"==typeof this.clientHints&&this.cloudinary.config().client_hints)&&(delete n["class"],delete n["data-src"],delete n.responsive),this.placeholderComponent&&this.placeholderHandler(n);var o=this.cloudinary.imageTag(this.publicId,n);this.setElementAttributes(r,o.attributes()),n.responsive&&this.cloudinary.responsive(r,n)}},t.prototype.setElementAttributes=function(r,n){var o=this;Object.keys(n).forEach(function(t){var e="src"===t&&"lazy"===o.loading?"data-src":t;r.setAttribute(e,n[t])})},t.prototype.placeholderHandler=function(e){var r={};Object.keys(e).forEach(function(t){r[t]="width"===t&&!e[t].startsWith("auto")||"height"===t?Math.floor(.1*parseInt(e[t],10)):e[t]}),this.placeholderComponent.options=r},t.decorators=[{type:n.Component,args:[{selector:"cl-image",template:"<img [ngStyle]=\"{opacity: shouldShowPlaceHolder ? '0' : '1', position: shouldShowPlaceHolder ? 'absolute' : 'unset'}\"(load)=\"hasLoaded()\">\n  <div [style.display]=\"shouldShowPlaceHolder ? 'inline' : 'none'\">\n      <ng-content></ng-content>\n  </div>\n  "}]}],t.ctorParameters=function(){return[{type:n.ElementRef},{type:l}]},t.propDecorators={publicId:[{type:n.Input,args:["public-id"]}],clientHints:[{type:n.Input,args:["client-hints"]}],loading:[{type:n.Input,args:["loading"]}],width:[{type:n.Input,args:["width"]}],height:[{type:n.Input,args:["height"]}],transformations:[{type:n.ContentChildren,args:[d]}],placeholderComponent:[{type:n.ContentChild,args:[p]}],onLoad:[{type:n.Output}],onError:[{type:n.Output}]},t}(),f=function(){function t(t,e,r){this.el=t,this.cloudinary=e,this.platformId=r}return t.prototype.ngOnInit=function(){var t=this;if("undefined"!=typeof MutationObserver){this.observer=new MutationObserver(function(){t.loadVideo(t.publicId)});this.observer.observe(this.el.nativeElement,{attributes:!0,childList:!0})}},t.prototype.ngOnChanges=function(t){t.publicId&&!t.publicId.isFirstChange()&&this.loadVideo(t.publicId.currentValue)},t.prototype.ngOnDestroy=function(){this.observer&&this.observer.disconnect&&this.observer.disconnect()},t.prototype.ngAfterViewInit=function(){if(!this.publicId)throw new Error("You must set the public id of the video to load, e.g. <cl-video public-id={{video.public_id}}...></cl-video>");this.loadVideo(this.publicId)},t.prototype.loadVideo=function(t){if(i.isPlatformBrowser(this.platformId)){var e=this.el.nativeElement,r=e.children[0],n=this.cloudinary.toCloudinaryAttributes(e.attributes,this.transformations),o=this.cloudinary.videoTag(t,n);this.appendSourceElements(r,o.content()),this.setElementAttributes(r,o.attributes())}},t.prototype.setElementAttributes=function(e,r){Object.keys(r).forEach(function(t){e.setAttribute(t,r[t])})},t.prototype.appendSourceElements=function(t,e){var r=document.createDocumentFragment();for(t.innerHTML=e;t.childNodes[0];)r.appendChild(t.childNodes[0]);t.appendChild(r)},t.decorators=[{type:n.Component,args:[{selector:"cl-video",template:"<video></video>"}]}],t.ctorParameters=function(){return[{type:n.ElementRef},{type:l},{type:Object,decorators:[{type:n.Inject,args:[n.PLATFORM_ID]}]}]},t.propDecorators={publicId:[{type:n.Input,args:["public-id"]}],transformations:[{type:n.ContentChildren,args:[d]}]},t}(),y=function(){function t(t,e){this.el=t,this.cloudinary=e}return t.prototype.ngAfterViewInit=function(){if(u()){var t=void 0,e=void 0;this.clHref?(t="href",e=this.clHref):this.clSrc?(t="src",e=this.clSrc):this.clSrcset&&(t="srcset",e=this.clSrcset);var r=!1;if(this.clHref&&toString.call("[object SVGAnimatedString]"===this.el.nativeElement.href)&&(this.el.nativeElement.setAttribute("xlinkHref","xlink:href"),r=!0),!t||!e)throw new Error("Directive value is missing for clHref/clSrc/clSrcset");var n=this.el.nativeElement,o=this.cloudinary.toCloudinaryAttributes(n.attributes,this.transformations),i=this.cloudinary.url(e,o);this.el.nativeElement.setAttribute(t,i),this.el.nativeElement.ownerDocument.documentMode&&!r&&(this.el.nativeElement[t]=i)}},t.decorators=[{type:n.Directive,args:[{selector:"[clHref], [clSrc], [clSrcset]"}]}],t.ctorParameters=function(){return[{type:n.ElementRef},{type:l}]},t.propDecorators={clHref:[{type:n.Input}],clSrc:[{type:n.Input}],clSrcset:[{type:n.Input}],transformations:[{type:n.ContentChildren,args:[d]}]},t}(),g=function(){function t(t,e,r){this.renderer=t,this.el=e,this.cloudinary=r}return t.prototype.isBrowser=function(){return"undefined"!=typeof window},t.prototype.ngAfterViewInit=function(){if(this.isBrowser()){var t=this.el.nativeElement,e=this.cloudinary.toCloudinaryAttributes(t.attributes,this.transformations),r=this.cloudinary.url(this.clBackgroundImage,e);this.renderer.setStyle(t,"background-image","url('"+r+"')"),this.renderer.setStyle(t,"background-repeat","no-repeat"),this.renderer.setStyle(t,"background-position","center")}},t.decorators=[{type:n.Directive,args:[{selector:"[clBackgroundImage]"}]}],t.ctorParameters=function(){return[{type:n.Renderer2},{type:n.ElementRef},{type:l}]},t.propDecorators={clBackgroundImage:[{type:n.Input}],transformations:[{type:n.ContentChildren,args:[d]}]},t}(),m=function(){function t(t){this.el=t}return t.prototype.ngAfterViewInit=function(){!this.isNativeLazyLoadSupported()&&this.isLazyLoadSupported()?this.lazyLoad():this.loadImage()},t.prototype.loadImage=function(){var t=this.el.nativeElement.children[0];t.setAttribute("src",t.dataset.src)},t.prototype.isLazyLoadSupported=function(){return window&&"IntersectionObserver"in window},t.prototype.isNativeLazyLoadSupported=function(){return"loading"in HTMLImageElement.prototype},t.prototype.lazyLoad=function(){var e=this,r={rootMargin:"0px 0px -50% 0px"},n=new IntersectionObserver(function(t){t.forEach(function(t){t.isIntersecting&&(e.loadImage(),n.unobserve(t.target))},r)});n.observe(this.el.nativeElement)},t.decorators=[{type:n.Directive,args:[{selector:"cl-image[loading=lazy]"}]}],t.ctorParameters=function(){return[{type:n.ElementRef}]},t}(),v=new n.InjectionToken("CLOUDINARY_LIB"),b=new n.InjectionToken("CLOUDINARY_CONFIGURATION");function I(t,e){return new l(t,e)}var C=function(){function r(){}return r.forRoot=function(t,e){return{ngModule:r,providers:[{provide:v,useValue:t},{provide:b,useValue:e},{provide:l,useFactory:I,deps:[v,b]}]}},r.decorators=[{type:n.NgModule,args:[{imports:[i.CommonModule],declarations:[y,g,h,f,d,m,p],exports:[y,g,h,f,d,m,p]}]}],r}();t.provideCloudinary=function w(t,e){return{provide:l,useFactory:function(){return new l(t,e)}}},t.Cloudinary=l,t.isJsonLikeString=e,t.isNamedNodeMap=a,t.transformKeyNames=c,t.namedNodeMapToObject=s,t.isBrowser=u,t.createCloudinary=I,t.CloudinaryImage=h,t.CloudinaryVideo=f,t.CloudinaryTransformationDirective=d,t.CloudinaryImageSourceDirective=y,t.CloudinaryBackgroundImageDirective=g,t.LazyLoadDirective=m,t.CloudinaryPlaceHolder=p,t.CLOUDINARY_LIB=v,t.CLOUDINARY_CONFIGURATION=b,t.CloudinaryModule=C,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=cloudinary-angular-5.x.umd.min.js.map